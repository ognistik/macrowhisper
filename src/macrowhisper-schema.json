{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/oristarium/macrowhisper-cli/blob/main/macrowhisper-schema.json",
  "title": "Macrowhisper Configuration",
  "description": "Configuration schema for Macrowhisper, an automation helper for Superwhisper dictation app. CLI commands create actions with empty values for string fields and null for boolean/numeric fields ‚Äî both fall back to global defaults. Explicit values override global defaults.",
  "type": "object",
  "properties": {
    "$schema": {
      "type": "string",
      "description": "JSON Schema reference for IDE validation support. Auto detected by Macrowhisper next to binary or in Homebrew's share/macrowhisper folder"
    },
    "defaults": {
      "type": "object",
      "description": "Global default settings for all actions",
      "properties": {
        "watch": {
          "type": "string",
          "description": "Path to Superwhisper recordings folder",
          "examples": ["~/Documents/superwhisper", "/Users/username/Documents/superwhisper"]
        },
        "noUpdates": {
          "type": "boolean",
          "description": "Disable automatic update checking",
          "default": false
        },
        "noNoti": {
          "type": "boolean",
          "description": "Disable system notifications",
          "default": false
        },
        "activeAction": {
          "type": ["string", "null"],
          "description": "Name of the currently active action (fallback when no triggers match). Empty string or null means no active action.",
          "examples": ["autoPaste", "myCustomAction", "", null],
          "default": ""
        },
        "icon": {
          "type": ["string", "null"],
          "description": "Default icon for actions (emoji, character, empty string, null, or '.none' for no icon)",
          "examples": ["üé§", "üìù", "‚ö°", "", null, ".none"],
          "default": ""
        },
        "moveTo": {
          "type": ["string", "null"],
          "description": "Default location to move recording folders after processing. Path to destination directory, '.delete' (delete folder), '.none' (keep in original location), empty string, or null for no default move behavior",
          "examples": ["~/Documents/processed-recordings", ".delete", ".none", "", null],
          "default": ""
        },
        "noEsc": {
          "type": "boolean",
          "description": "Disable ESC key simulation before action execution",
          "default": false
        },
        "simKeypress": {
          "type": "boolean",
          "description": "Use keystroke simulation instead of clipboard for text insertion",
          "default": false
        },
        "actionDelay": {
          "type": "number",
          "description": "Default delay in seconds before executing actions",
          "minimum": 0,
          "default": 0
        },
        "history": {
          "type": ["integer", "null"],
          "description": "Number of days to retain recording history (null = keep forever, 0 = keep only latest)",
          "minimum": 0,
          "examples": [7, 30, 0, null]
        },
        "pressReturn": {
          "type": "boolean",
          "description": "Automatically press Return/Enter after action execution. This action can be scheduled with --auto-return <true/false> CLI flag.",
          "default": false
        },
        "returnDelay": {
          "type": "number",
          "description": "Delay in seconds before pressing Return (if pressReturn is enabled)",
          "minimum": 0,
          "default": 0.1
        },
        "restoreClipboard": {
          "type": "boolean",
          "description": "Restore original clipboard content after action execution",
          "default": true
        },
        "scheduledActionTimeout": {
          "type": "number",
          "description": "Timeout in seconds for auto-return and scheduled actions when no recording session is active (0 = no timeout, 5 = default)",
          "minimum": 0,
          "default": 5
        }
      },
      "required": ["watch", "noUpdates", "noNoti", "noEsc", "simKeypress", "actionDelay", "pressReturn", "returnDelay", "restoreClipboard", "scheduledActionTimeout"],
      "additionalProperties": false
    },
    "inserts": {
      "type": "object",
      "description": "Text insertion actions with placeholder support. Manage via CLI: --add-insert <name>, --list-inserts, --remove-action <name>",
      "patternProperties": {
        ".*": {
          "title": "Insert Action",
          "description": "Action name - defines a text insertion action",
          "$ref": "#/definitions/insertAction"
        }
      }
    },
    "urls": {
      "type": "object",
      "description": "URL opening actions for web links and applications. Manage via CLI: --add-url <name>, --list-urls, --remove-action <name>",
      "patternProperties": {
        ".*": {
          "title": "URL Action",
          "description": "Action name - defines a URL opening action for web links and applications",
          "$ref": "#/definitions/urlAction"
        }
      }
    },
    "shortcuts": {
      "type": "object",
      "description": "MacOS Shortcut actions. Manage via CLI: --add-shortcut <name>, --list-shortcuts, --remove-action <name>.",
      "patternProperties": {
        ".*": {
          "title": "macOS Shortcut Action",
          "description": "Action name - this property name is the actual macOS Shortcut name to execute",
          "$ref": "#/definitions/shortcutAction"
        }
      }
    },
    "scriptsShell": {
      "type": "object",
      "description": "Shell script execution actions. Manage via CLI: --add-shell <name>, --list-shell, --remove-action <name>",
      "patternProperties": {
        ".*": {
          "title": "Shell Script Action",
          "description": "Action name - defines a shell command execution action",
          "$ref": "#/definitions/shellScriptAction"
        }
      }
    },
    "scriptsAS": {
      "type": "object",
      "description": "AppleScript execution action. Manage via CLI: --add-as <name>, --list-as, --remove-action <name>",
      "patternProperties": {
        ".*": {
          "title": "AppleScript Action",
          "description": "Action name - defines an AppleScript execution action",
          "$ref": "#/definitions/applescriptAction"
        }
      }
    }
  },
  "required": ["defaults"],
  "additionalProperties": false,
  "definitions": {
    "baseActionProperties": {
      "type": "object",
      "properties": {
        "icon": {
          "type": ["string", "null"],
          "description": "Custom icon for this action. Empty string, null, or omit to use global default. Use '.none' to explicitly show no icon (override global default).",
          "examples": ["üé§", "üìù", "‚ö°", "üîó", "", null, ".none"],
          "default": ""
        },
        "moveTo": {
          "type": ["string", "null"],
          "description": "Where to move the recording folder after processing. Path to destination directory, '.delete' (delete folder), '.none' (keep in original location), empty string, null, or omit to use global default.",
          "examples": ["~/Documents/processed-recordings", "/Users/username/Archive", ".delete", ".none", "", null],
          "default": ""
        },
        "noEsc": {
          "type": ["boolean", "null"],
          "description": "Disable ESC key simulation for this action. null = use global default, true/false = explicit override.",
          "default": null
        },
        "actionDelay": {
          "type": ["number", "null"],
          "description": "Custom delay in seconds before executing this action. null = use global default, number = explicit override.",
          "minimum": 0,
          "default": null
        },
        "restoreClipboard": {
          "type": ["boolean", "null"],
          "description": "Override clipboard restoration setting for this action. null = use global default, true/false = explicit override.",
          "default": null
        },
        "triggerVoice": {
          "type": ["string", "null"],
          "description": "Keywords or phrases for voice trigger matching. null or empty string means no trigger.",
          "default": ""
        },
        "triggerApps": {
          "type": ["string", "null"], 
          "description": "Regex pattern for application trigger matching. null or empty string means no trigger.",
          "default": ""
        },
        "triggerModes": {
          "type": ["string", "null"],
          "description": "Regex pattern for Superwhisper mode trigger matching. null or empty string means no trigger.",
          "default": ""
        },
        "triggerLogic": {
          "type": ["string", "null"],
          "description": "Logic for combining multiple triggers. null defaults to 'or'.",
          "enum": ["and", "or"],
          "default": "or"
        }
      }
    },
    "insertAction": {
      "allOf": [
        {"$ref": "#/definitions/baseActionProperties"},
        {
          "type": "object",
          "properties": {
            "action": {
              "type": "string",
              "title": "Insert Action Content",
              "description": "Text to insert with placeholder support. Use '.autoPaste' for smart paste behavior, '.none' or empty string to skip insertion and not auto-close Superwhisper's window.",
              "examples": [
                "{{swResult}}",
                "{{result}}",
                "{{date:short}}\nDictation: {{result}}",
                ".autoPaste",
                ".none",
                ""
              ]
            },
            "simKeypress": {
              "type": ["boolean", "null"],
              "description": "Use keystroke simulation instead of clipboard for this action. null = use global default, true/false = explicit override.",
              "default": null
            },
            "pressReturn": {
              "type": ["boolean", "null"],
              "description": "Automatically press Return after this action. null = use global default, true/false = explicit override.",
              "default": null
            }
          },
          "required": ["action"]
        }
      ]
    },
    "urlAction": {
      "allOf": [
        {"$ref": "#/definitions/baseActionProperties"},
        {
          "type": "object",
          "properties": {
            "action": {
              "type": "string",
              "title": "URL to Open",
              "description": "URL with placeholder support. This field is required and cannot be empty.",
              "minLength": 1,
              "examples": [
                "https://google.com/search?q={{result}}",
                "https://www.perplexity.ai/?q={{result||\\.$||}}"
              ]
            },
            "openWith": {
              "type": ["string", "null"],
              "description": "Specific application or bundle id to open the URL with. Empty string, null, or omit uses system default.",
              "examples": ["Safari", "/Applications/Google Chrome.app", "com.google.Chrome", "", null],
              "default": ""
            },
            "openBackground": {
              "type": ["boolean", "null"],
              "description": "Open URL in background without focusing the application. null = use global default, true/false = explicit override.",
              "default": null
            }
          },
          "required": ["action"]
        }
      ]
    },
    "shortcutAction": {
      "type": "object",
      "description": "The action name is the actual Shortcut name to execute.",
      "properties": {
          "action": {
          "type": "string",
          "description": "Input to pass to the shortcut with placeholder support. Use '.none' or empty string to run the shortcut without any input.",
          "examples": ["{{swResult}}", "Process this: {{result}}", ".none", ""]
        },
        "icon": {
          "type": ["string", "null"],
          "description": "Custom icon for this shortcut action. Empty string, null, or omit to use global default. Use '.none' to explicitly show no icon (override global default).",
          "examples": ["üé§", "üìù", "‚ö°", "üîó", "", null, ".none"],
          "default": ""
        },
        "moveTo": {
          "type": ["string", "null"],
          "description": "Where to move the recording folder after processing this shortcut. Path to destination directory, '.delete' (delete folder), '.none' (keep in original location), empty string, null, or omit to use global default.",
          "examples": ["~/Documents/processed-recordings", "/Users/username/Archive", ".delete", ".none", "", null],
          "default": ""
        },
        "noEsc": {
          "type": ["boolean", "null"],
          "description": "Disable ESC key simulation for this shortcut. null = use global default, true/false = explicit override.",
          "default": null
        },
        "actionDelay": {
          "type": ["number", "null"],
          "description": "Custom delay in seconds before executing this shortcut. null = use global default, number = explicit override.",
          "minimum": 0,
          "default": null
        },
        "restoreClipboard": {
          "type": ["boolean", "null"],
          "description": "Override clipboard restoration setting for this shortcut. null = use global default, true/false = explicit override.",
          "default": null
        },
        "triggerVoice": {
          "type": ["string", "null"],
          "description": "Keywords or phrases for voice trigger matching. Use '!' prefix for exceptions and '|' for multiple triggers. Wrap patterns in '=' for raw regex (e.g., '=^exact match$='). Empty string, null, or omit means no trigger.",
          "examples": ["summarize", "(email|mail)", "!my phrase", "=^google this\\.?$=", "=.*ends with this$=", "", null],
          "default": ""
        },
        "triggerApps": {
          "type": ["string", "null"],
          "description": "Regex pattern for application trigger matching (app name or bundle ID). Empty string, null, or omit means no trigger.",
          "examples": ["com.apple.mail", "Mail|Notes", "^com\\.apple\\.", "", null],
          "default": ""
        },
        "triggerModes": {
          "type": ["string", "null"],
          "description": "Regex pattern for Superwhisper mode trigger matching. Empty string, null, or omit means no trigger.",
          "examples": ["email", "writing|notes", "^(email|writing)$", "", null],
          "default": ""
        },
        "triggerLogic": {
          "type": ["string", "null"],
          "description": "Logic for combining multiple triggers. null or omit uses default 'or' logic.",
          "enum": ["and", "or"],
          "default": "or"
        }
      },
      "required": ["action"],
      "additionalProperties": false
    },
    "shellScriptAction": {
      "allOf": [
        {"$ref": "#/definitions/baseActionProperties"},
        {
          "type": "object",
          "description": "Action name. Add new: macrowhisper --add-shell <name>",
          "properties": {
            "action": {
              "type": "string",
              "title": "Shell Command",
              "description": "Shell command with placeholder support and proper escaping. This field is required and cannot be empty.",
              "minLength": 1,
              "examples": [
                "echo '{{swResult}}' | pbcopy",
                "curl -X POST 'https://api.example.com' -d '{{json:swResult}}'",
                "osascript -e 'display notification \"{{result}}\"'"
              ]
            }
          },
          "required": ["action"]
        }
      ]
    },
    "applescriptAction": {
      "allOf": [
        {"$ref": "#/definitions/baseActionProperties"},
        {
          "type": "object",
          "description": "Action name. Add new: macrowhisper --add-as <name>",
          "properties": {
            "action": {
              "type": "string",
              "title": "AppleScript Code",
              "description": "AppleScript code with placeholder support and proper quote escaping. This field is required and cannot be empty.",
              "minLength": 1,
              "examples": [
                "tell application \"TextEdit\" to make new document with properties {text:\"{{json:swResult}}\"}",
                "tell application \"Keyboard Maestro Engine\" to do script \"Sample Macro\" with parameter \"{{swResult}}\"",
                "{{raw:swResult}}"
              ]
            }
          },
          "required": ["action"]
        }
      ]
    }
  }
}